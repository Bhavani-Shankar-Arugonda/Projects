<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Students Details</h1>

    <div class="add">
        <form id="addform" action="/add" method="post">
            <input type="text" name="name" placeholder="Enter name" required>
            <input type="email" name="email" placeholder="Enter email" required>
            <input type="date" name="dob" placeholder="Enter dob" required>
            <input type="tel" name="phone" placeholder="Enter phone number" required>
            <input type="password" name="password" placeholder="Enter password" required>
            <button type="submit" name="submit">Submit</button>
        </form>
    </div>

    <div class="update">
        <form id="updateform" action="/update" method="post">
            <input type="text" name="name" placeholder="Enter name" required>
            <input type="email" name="email" placeholder="Enter email" required>
            <input type="date" name="dob" placeholder="Enter dob" required>
            <input type="tel" name="phone" placeholder="Enter phone number" required>
            <input type="password" name="password" placeholder="Enter password" required>
            <button type="submit" name="submit">Submit</button>
        </form>
    </div>

    <div class="delete">
        <form id="deleteform" action="/delete" method="post">
            <input type="text" name="name" placeholder="Enter name" required>
            <button type="submit">Submit</button>
        </form>
    </div>

    <pre id="display"></pre>

    <script>
        $(document).ready(() => {
            $("#addform").on("submit", (e) => {
                e.preventDefault();

                const name = $("#addform input[name='name']").val().trim();
                const email = $("#addform input[name='email']").val().trim();
                const date = $("#addform input[name='dob']").val().trim();
                const phone = $("#addform input[name='phone']").val().trim();
                const password = $("#addform input[name='password']").val().trim();

                if (!name || !email || !date || !phone || !password) {
                    alert("Please fill all the fields");
                    return;
                }

                const nameRegx = /^[a-zA-Z\s]+$/;
                const emailRegx = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
                const dateRegx = /^\d{4}-\d{2}-\d{2}$/;
                const phoneRegx = /^\d{10}$/;
                const passwordRegx = /^(?=.*[A-Z])(?=.*\d)(?=.*[@#$%^*!])[A-Za-z\d@#$%^*!]{8,}$/;

                if (!nameRegx.test(name)) {
                    alert("Enter a valid name (letters and spaces only)");
                    return;
                }

                if (!emailRegx.test(email)) {
                    alert("Enter a valid email");
                    return;
                }

                if (!dateRegx.test(date)) {
                    alert("Enter a valid date (YYYY-MM-DD)");
                    return;
                }

                if (!phoneRegx.test(phone)) {
                    alert("Enter a valid 10-digit phone number");
                    return;
                }

                if (!passwordRegx.test(password)) {
                    alert("Password must be at least 8 characters long with at least one uppercase letter, one number, and one special character (@#$%^*!)");
                    return;
                }

                $("#addform").off("submit").submit();
            });

            $.get("/display", (data) => {
                const newdata = data.map(user => `${user.name}\n${user.email}\n\n`).join("");
                $("#display").text(newdata);
            });
        });
    </script>
</body>
</html>